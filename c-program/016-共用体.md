# C语言公用体

共用体是一种特殊的数据结构，允许在相同的内存位置存储不同的数据类型。可以定义一个带有多成员的共用体，但是任何时候都只能有一个成员带有值。共用体提供了一种使用相同的内存位置的有效方式。

## 定义共用体

定义方式与定义结构类似，但是关键字为`union`。union语句定义了一个新的数据类型，带有多个成员。

```C
union [union tag]{
  member def;
  member def;
  ...
}[one or more union variables];

union Data{
  int i;
  float f;
  char str[20];
}
```

共用体占用的内存应足够存储共用体中最大的成员（上面的共用体占用20个字节）。另外占用内存为占空间最大的类型的占用的整数倍。例如下面程序的输出为12，是因为最小空间为9字节，然后取最大类型int的整数倍，即为12。

```c
union UnionData{
  int i;
  int d[2];
  char str[9];
} union_data;

int main(){
  printf("union size:%d\n", sizeof(union_data));
}
```

## 共用体的使用

使用方法跟结构体类似，也是用成员访问运算符`.`来访问共用体的成员。

## 共用体的作用及使用场景

共用体可以节省内存，如果有两个很大的数据结构，但是这两者并不会同时使用，就很适合使用共用体。

应用场景：通信中的数据包会用到共用体，因为不知道对方会发来一个什么包，可以用共用体定义几种格式，收到包后根据包的格式取出数据。
